<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog 
		http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">

	<changeSet author="mat_dev_user" id="1" context="prod">
		<sql>
		ALTER TABLE MEASURE ADD 
			MEASURE_STEWARD_ID INT DEFAULT NULL;
			
		ALTER TABLE MEASURE ADD
			CONSTRAINT FOREIGN KEY (`MEASURE_STEWARD_ID`) REFERENCES `ORGANIZATION`(`ORG_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION;
		
		
		CREATE TABLE `MEASURE_DETAILS` (
			`ID` INT NOT NULL AUTO_INCREMENT,
			`MEASURE_ID` VARCHAR(64) NOT NULL,
			`DESCRIPTION` LONGTEXT,
			`COPYRIGHT` LONGTEXT,
			`DISCLAIMER` LONGTEXT,
			`STRATIFICATION` LONGTEXT,
			`RISK_ADJUSTMENT` LONGTEXT,
			`RATE_AGGREGATION` LONGTEXT,
			`RATIONALE` LONGTEXT,
			`CLINICAL_RECOMMENDATION` LONGTEXT,
			`IMPROVEMENT_NOTATION` LONGTEXT,
			`DEFINITION` LONGTEXT,
			`GUIDANCE` LONGTEXT,
			`TRANSMISSION_FORMAT` LONGTEXT,
			`INITIAL_POPULATION` LONGTEXT,
			`DENOMINATOR` LONGTEXT,
			`DENOMINATOR_EXCLUSIONS` LONGTEXT,
			`NUMERATOR` LONGTEXT,
			`NUMERATOR_EXCLUSIONS` LONGTEXT,
			`MEASURE_OBSERVATIONS` LONGTEXT,
			`MEASURE_POPULATION` LONGTEXT,
			`MEASURE_POPULATION_EXCLUSIONS` LONGTEXT,
			`DENOMINATOR_EXCEPTIONS` LONGTEXT,
			`SUPPLEMENTAL_DATA_ELEMENTS` LONGTEXT,
			`MEASURE_SET` LONGTEXT,
			PRIMARY KEY (`ID`),
            CONSTRAINT `MEASURE_DETAILS_MEASURE_ID_FK` FOREIGN KEY (`MEASURE_ID`) REFERENCES `MEASURE`(`ID`) ON DELETE CASCADE ON UPDATE NO ACTION
			) ENGINE=InnoDB DEFAULT CHARSET=latin1;
		

		CREATE TABLE `MEASURE_DETAILS_REFERENCE` (
			`ID` INT NOT NULL AUTO_INCREMENT,
			`MEASURE_DETAILS_ID`INT NOT NULL,
			`REFERENCE` LONGTEXT,
			`REFERENCE_NUMBER` INT,
			PRIMARY KEY (`ID`),
 			CONSTRAINT `MEASURE_DETAILS_REFERENCE_MEASURE_DETAILS_ID_FK` FOREIGN KEY (`MEASURE_DETAILS_ID`) REFERENCES `MEASURE_DETAILS`(`ID`) ON DELETE CASCADE ON UPDATE NO ACTION
 			) ENGINE=InnoDB DEFAULT CHARSET=latin1;

			
			
		CREATE TABLE `MEASURE_TYPE_ASSOCIATION` (
			`ID` INT NOT NULL AUTO_INCREMENT,
			`MEASURE_ID` VARCHAR(64) NOT NULL,
			`MEASURE_TYPE_ID` VARCHAR(32) NOT NULL,
			PRIMARY KEY (`ID`),
			CONSTRAINT `MEASURE_TYPE_ID_FK` FOREIGN KEY (`MEASURE_TYPE_ID`) REFERENCES `MEASURE_TYPES`(`ID`) ON DELETE CASCADE ON UPDATE NO ACTION,
            CONSTRAINT `MEASURE_MEASURE_TYPE_MEASURE_ID_FK` FOREIGN KEY (`MEASURE_ID`) REFERENCES `MEASURE`(`ID`) ON DELETE CASCADE ON UPDATE NO ACTION
			) ENGINE=InnoDB DEFAULT CHARSET=latin1;
			
			
		CREATE TABLE `MEASURE_DEVELOPER_ASSOCIATION` (
			`ID` INT NOT NULL AUTO_INCREMENT,
			`MEASURE_ID` VARCHAR(64) NOT NULL,
			`MEASURE_DEVELOPER_ID` INT,
			PRIMARY KEY (`ID`),
			CONSTRAINT `MEASURE_MEASURE_DEVELOPER_MEASURE_ID_FK` FOREIGN KEY (`MEASURE_ID`) REFERENCES `MEASURE`(`ID`) ON DELETE CASCADE ON UPDATE NO ACTION,
            CONSTRAINT `MEASURE_DEVELOPER_ID_FK` FOREIGN KEY (`MEASURE_DEVELOPER_ID`) REFERENCES `ORGANIZATION`(`ORG_ID`) ON DELETE CASCADE ON UPDATE NO ACTION
			) ENGINE=InnoDB DEFAULT CHARSET=latin1;
		
		</sql>
	</changeSet>

</databaseChangeLog>